---
id: validation
title: "üõ°Ô∏è Validation"
---

import SuggestionFeature from "@site/src/components/Partials/SuggestionFeature";

# Validation des donn√©es

## Introduction

:::info
La validation des donn√©es est une partie cruciale de toute application web. Bow Framework fournit un syst√®me de validation simple, √©l√©gant et puissant qui vous permet de valider facilement vos donn√©es entrantes.
:::

## Utilisation de base

:::tip Conseil
La fa√ßon la plus simple d'utiliser le validateur est via la fonction helper `validator()`. Voici un exemple simple :
:::

```php
$data = [
  "name" => "John Doe",
  "email" => "john@example.com",
  "age" => 25
];

$validation = validator($data, [
  "name" => "required|min:3|max:50",
  "email" => "required|email",
  "age" => "required|int"
]);

if ($validation->fails()) {
  // La validation a √©chou√©
  $errors = $validation->getMessages();
  // G√©rer les erreurs
}
```

## R√®gles de validation disponibles

:::info R√®gles
Bow Framework propose un large √©ventail de r√®gles de validation pour couvrir la plupart des besoins de validation courants.
:::

### R√®gles de base

| R√®gle | Description |
|-------|-------------|
| `required` | Le champ est obligatoire |
| `required_if:field1,field2` | Le champ est obligatoire si les champs sp√©cifi√©s existent |
| `email` | Le champ doit √™tre une adresse email valide |
| `min:value` | La longueur minimale du champ |
| `max:value` | La longueur maximale du champ |
| `size:value` | La longueur exacte du champ |
| `same:value` | Le champ doit √™tre identique √† la valeur sp√©cifi√©e |

### R√®gles de type

| R√®gle | Description |
|-------|-------------|
| `alpha` | Uniquement des caract√®res alphab√©tiques |
| `alphanum` | Uniquement des caract√®res alphanum√©riques |
| `number` | Le champ doit √™tre un nombre |
| `int` | Le champ doit √™tre un entier |
| `float` | Le champ doit √™tre un nombre d√©cimal |

### R√®gles de format

| R√®gle | Description |
|-------|-------------|
| `date` | Format de date (YYYY-MM-DD) |
| `datetime` | Format datetime (YYYY-MM-DD HH:MM:SS) |
| `regex:pattern` | Le champ doit correspondre au pattern regex |
| `lower` | Uniquement des lettres minuscules |
| `upper` | Uniquement des lettres majuscules |

### R√®gles de base de donn√©es

| R√®gle | Description |
|-------|-------------|
| `unique:table,column` | La valeur doit √™tre unique dans la table |
| `exists:table,column` | La valeur doit exister dans la table |
| `!exists:table,column` | La valeur ne doit pas exister dans la table |

## Messages d'erreur personnalis√©s

:::tip Personnalisation
Vous pouvez personnaliser les messages d'erreur en passant un tableau de messages comme troisi√®me argument :
:::

```php
$validation = validator($data, [
  "name" => "required|min:3",
  "email" => "required|email"
], [
  "name" => [
    "required" => "Le nom est obligatoire",
    "min" => "Le nom doit contenir au moins 3 caract√®res"
  ],
  "email" => [
    "required" => "L'email est obligatoire",
    "email" => "L'email n'est pas valide"
  ]
]);
```

## R√©cup√©ration des erreurs

:::tip M√©thodes disponibles
Le validateur fournit plusieurs m√©thodes pour r√©cup√©rer les informations sur les erreurs :
:::

```php
// V√©rifie si la validation a √©chou√©
$validation->fails(); // bool

// R√©cup√®re tous les messages d'erreur
$validation->getMessages(); // array

// R√©cup√®re le dernier message d'erreur
$validation->getLastMessage(); // string

// R√©cup√®re les champs qui ont √©chou√©
$validation->getCorruptedFields(); // array

// R√©cup√®re les r√®gles qui ont √©chou√©
$validation->getFailsRules(); // array
```

## Validation et exceptions

:::warning Exceptions
Vous pouvez lancer une exception de validation avec la m√©thode `throwError()` :
:::

```php
$validation = validator($data, $rules);

if ($validation->fails()) {
  $validation->throwError(); // Lance ValidationException
}
```

L'exception contiendra les messages d'erreur et d√©finira automatiquement le code de statut HTTP √† 400.

## Validation dans les contr√¥leurs

Voici un exemple pratique d'utilisation du validateur dans un contr√¥leur:

```php
class UserController
{
  public function store()
  {
    $validation = validator(request()->all(), [
      "name" => "required|min:3|max:50",
      "email" => "required|email|unique:users,email",
      "password" => "required|min:6"
    ]);

    if ($validation->fails()) {
      return response()->json([
        "errors" => $validation->getMessages()
      ], 400);
    }

    // Cr√©er l'utilisateur
    User::create(request()->all());

    return response()->json([
      "message" => "Utilisateur cr√©√© avec succ√®s"
    ]);
  }
}
```

## Bonnes pratiques

:::tip Recommandations
Suivez ces bonnes pratiques pour une validation efficace et s√©curis√©e :
:::

1. **Validation pr√©coce** : Validez les donn√©es le plus t√¥t possible dans le cycle de vie de la requ√™te.
2. **Messages clairs** : Utilisez des messages d'erreur descriptifs et compr√©hensibles.
3. **R√®gles compos√©es** : Combinez plusieurs r√®gles pour une validation robuste.
4. **S√©curit√©** : Utilisez toujours la validation c√¥t√© serveur, m√™me si vous avez une validation c√¥t√© client.

<SuggestionFeature />
