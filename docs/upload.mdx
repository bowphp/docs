---
id: http-upload
title: "üõ´ Envoie de fichier"
---

import SuggestionFeature from "@site/src/components/Partials/SuggestionFeature";

- [Traiter les fichiers envoy√©s](#traiter-les-fichiers-envoy√©s)
- [Determiner si un fichier existe](#determiner-si-un-fichier-existe)
- [Validation des t√©l√©chargements r√©ussis](#validation-des-t√©l√©chargements-r√©ussis)
- [Savegarder le fichier](#savegarder-le-fichier)
- [Il manque quelque chose ?](#il-manque-quelque-chose-)

## Traiter les fichiers envoy√©s

Souvent les requ√™tes sont associ√©s √† des fichiers envoy√©s par l'utilisateur, vous pouvez traiter ces fichiers sur [`Bow\Http\Request`](https://bowphp.com/api/master/Bow/Http/Request.html) les m√©thodes `file` et le helper du m√™me nom.

Consid√©rons le formulaire suivant:

```html
<form action="/upload" method="post" enctype="multipart/form-data">
  <input type="file" name="photo" accept="image/png"><br/>
  <button type="submit">Uploader</button>
</form>
```

> Comment avoir acc√®s au fichier envoy√© ?

Ici nous pouvons utiliser la m√©thode `file` qui retourne `null` ou une instance de [`Bow\Http\UploadFile`](https://bowphp.com/api/master/Bow/Http/UploadFile.html).

```php
use Bow\Http\Request;

$app->post('/upload', function(Request $request) {
  $file = $request->file('photo');
  // ou
  $file = file('photo');

  debug($file);
});
```

Le resultat de `debug` :

```php
// Debug output
UploadFile {#92 ‚ñº
  -file: array:5 [‚ñº
    "name" => "23270116.png"
    "type" => "image/png"
    "tmp_name" => "/tmp/phpellwCx"
    "error" => 0
    "size" => 7388
  ]
}
```

## Determiner si un fichier existe

Vous pouvez d√©terminer si un fichier est pr√©sent sur la requ√™te en utilisant la m√©thode `hasFile`:

```php
if ($request->hasFile('photo')) {
  //
}
```

## Validation des t√©l√©chargements r√©ussis

Vous pouvez v√©rifier qu'il n'y a pas eu de probl√®mes lors du t√©l√©chargement avec la m√©thode `isUploaded`:

```php
$file = $request->file('photo');

if ($file->isUploaded()) {
  // Code ici
}
```

## Savegarder le fichier

Cela consiste juste √† d√©placer le fichier uploader dans une autre dossier et ceci grace √† la m√©thode `moveTo`.

```php
$file = $request->file('photo');

$file->moveTo("/path/to/your/store/directory", $filename = null);
```

Si `$filename` est `null`, sa valeur sera le nom du fichier hasher avec la m√©thode [`getHashName`](https://bowphp.com/api/master/Bow/Http/UploadFile.html#method_getHashName).

Souvent dans le cas o√π vous attendez des fichiers envoy√© via un formulaire dont le champs est sous la forme `photo[]`. la m√©thode `file` retourne une [`Bow\Support\Collection`](https://bowphp.com/api/master/Bow/Support/Collection.html):

```html
<form action="/upload" method="post" enctype="multipart/form-data">
  <label>Fichier 1: <input type="file" name="photo[]" accept="image/png"></label><br/>
  <label>Fichier 2: <input type="file" name="photo[]" accept="image/png"></label><br/>
  <button type="submit">Uploader</button>
</form>
```

Dans cette exemple, la m√©thode `file` retournera une [`Bow\Support\Collection`](https://bowphp.com/api/master/Bow/Support/Collection.html) qui contiendra pour chaque oruccencre une instance de [`Bow\Http\UploadFile`](https://bowphp.com/api/master/Bow/Http/UploadFile.html).

```php
use Bow\Http\Request;
use Bow\Http\UploadFile;

$app->get('/upload', function (Request $request)
{
  $files = $request->file('photo');

  if (!$files->isEmpty()) {
    $files->each(function(UploadFile $file) {
      $file->moveTo("/path/to/your/store/directory");
    });
  }
});
```

<SuggestionFeature />
