---
id: concept
title: "ğŸ‘¨ğŸ½â€ğŸ’» Concept et Architecture"
---

import SuggestionFeature from "@site/src/components/Partials/SuggestionFeature";

## Comprendre le cycle de vie d'une requÃªte dans BowPHP

BowPHP est un framework PHP lÃ©ger, conÃ§u pour offrir une structure claire et modulaire. Lorsqu'une requÃªte arrive, elle suit un chemin bien dÃ©fini appelÃ© **cycle de vie d'une requÃªte**. Ce cycle est organisÃ© pour sÃ©parer les responsabilitÃ©s, rendre le code facile Ã  maintenir et amÃ©liorer les performances.

### Le cycle de vie d'une requÃªte expliquÃ©

Chaque requÃªte passe par plusieurs Ã©tapes avant de gÃ©nÃ©rer une rÃ©ponse pour l'utilisateur.

Voici les Ã©tapes principales :

1. **RequÃªte HTTP** : L'utilisateur envoie une requÃªte via son navigateur ou une API.
2. **Request** : Le framework capture cette requÃªte et extrait les donnÃ©es nÃ©cessaires (URL, paramÃ¨tres, corps, etc.).
3. **Kernel** : Le Kernel est le cÅ“ur du framework. Il :
  - Charge les fichiers de configuration situÃ©s dans le dossier `config` (comme `config/database.php`).
  - Initialise les modules nÃ©cessaires Ã  l'application.
4. **Application** : Elle dÃ©marre le Kernel et prÃ©pare l'environnement pour traiter la requÃªte.
5. **Routeur** :
  - Le routeur dÃ©tecte la route correspondant Ã  la requÃªte (par exemple, `/users/42` ou `/api/login`).
  - Il associe cette route Ã  un contrÃ´leur et une mÃ©thode spÃ©cifique, dÃ©finis directement dans le code des routes.
  - Si des middlewares sont dÃ©finis pour cette route, ils sont exÃ©cutÃ©s avant d'appeler le contrÃ´leur.
6. **Middleware** : Les middlewares effectuent des traitements spÃ©cifiques, comme vÃ©rifier l'authentification ou valider les donnÃ©es.
7. **ContrÃ´leur** : Une fois la route validÃ©e, le contrÃ´leur exÃ©cute la logique mÃ©tier (par exemple, rÃ©cupÃ©rer des donnÃ©es ou effectuer une action).
8. **ModÃ¨le** : Si des donnÃ©es sont nÃ©cessaires, le modÃ¨le interagit avec la base de donnÃ©es pour les rÃ©cupÃ©rer ou les mettre Ã  jour.
9. **Vue** : Le contrÃ´leur renvoie les donnÃ©es rÃ©cupÃ©rÃ©es au composant Vue, qui gÃ©nÃ¨re le contenu final (HTML, JSON, etc.).
10. **RÃ©ponse HTTP** : La rÃ©ponse est envoyÃ©e Ã  l'utilisateur.

### Le rÃ´le du routeur en dÃ©tail

Le routeur est un composant clÃ© de BowPHP. Il agit comme une "boussole" qui oriente chaque requÃªte vers le bon contrÃ´leur et la bonne mÃ©thode.

#### DÃ©tection de la route
Le routeur examine l'URL de la requÃªte et dÃ©termine quelle route correspond. Les routes sont dÃ©finies dans des fichiers dÃ©diÃ©s (souvent routes/web.php ou routes/api.php).

Exemple de dÃ©finition de route :

```php
$app->get('/users/{id}', 'UserController@show');
$app->post('/api/login', 'AuthController@login');
```

:::note
Ici :
La requÃªte `GET /users/42` est associÃ©e Ã  la mÃ©thode show du contrÃ´leur UserController.
La requÃªte `POST /api/login` est associÃ©e Ã  la mÃ©thode login du contrÃ´leur AuthController.
:::

#### Association au contrÃ´leur

Une fois la route dÃ©tectÃ©e, le routeur :

- Valide les paramÃ¨tres de l'URL (comme `{id}`).
- ExÃ©cute les middlewares dÃ©finis pour cette route (s'il y en a).
- Appelle le contrÃ´leur et la mÃ©thode associÃ©s Ã  la route.

### Une architecture modulaire

BowPHP repose sur une architecture modulaire. Chaque module est indÃ©pendant, possÃ©dant sa propre configuration et remplit un rÃ´le spÃ©cifique. Cela rend l'application facile Ã  gÃ©rer et Ã  Ã©tendre. Le routeur est un exemple de cette approche modulaire. Un autre exemple est le module Database, qui gÃ¨re les connexions Ã  la base de donnÃ©es.

#### Exemple : Le module Database

Prenons le cas du module **Database**, qui gÃ¨re les connexions Ã  la base de donnÃ©es :

**Fichier de configuration : `config/database.php`**

Ce fichier contient les paramÃ¨tres nÃ©cessaires pour se connecter Ã  la base de donnÃ©es. Voici un exemple simple :

```php title="config/database.php"
return [
    'default' => 'mysql',
    'connections' => [
        'mysql' => [
            'driver' => 'mysql',
            'host' => '127.0.0.1',
            'port' => 3306,
            'database' => 'bowphp_app',
            'username' => 'root',
            'password' => '',
            'charset' => 'utf8mb4',
            'collation' => 'utf8mb4_unicode_ci',
        ],
    ],
];
```

#### **Classe `Bow\Database\DatabaseConfiguration`**
Cette classe est chargÃ©e de lire les paramÃ¨tres du fichier `config/database.php` et d'Ã©tablir une connexion Ã  la base de donnÃ©es.

#### **RÃ´le du Kernel**
Au dÃ©marrage, le Kernel charge le fichier `config/database.php` Ã  l'aide de `DatabaseConfiguration` dÃ©fini dans `app/Kernel.php` et initialise une connexion Ã  la base de donnÃ©es, prÃªte Ã  Ãªtre utilisÃ©e par d'autres composants.

### Visualisation avec un diagramme

Voici une reprÃ©sentation visuelle pour mieux comprendre le cycle de vie d'une requÃªte et l'intÃ©gration modulaire (exemple avec **Database**) :
Charge les configurations

Voici un diagramme mis Ã  jour, mettant en Ã©vidence le rÃ´le du routeur et l'intÃ©gration modulaire (exemple avec Database)

```mermaid
graph TB
    A[RequÃªte HTTP] -->|EntrÃ©e utilisateur| B[Request]
    B -->|Passe la requÃªte| C[Kernel]
    C -->|Charge les modules| D[Routeur]
    D -->|VÃ©rifie la route et<br>appelle le contrÃ´leur| E[Middleware]
    E -->|Valide la requÃªte<br>et continue| F[ContrÃ´leur]
    F -->|ExÃ©cute la logique mÃ©tier| G[ModÃ¨le]
    G -->|Interaction avec| H[(Base de donnÃ©es)]
    F -->|Retourne les donnÃ©es| I[Vue]
    I -->|GÃ©nÃ¨re la rÃ©ponse HTML/JSON| J[RÃ©ponse HTTP]

    subgraph Framework BowPHP
        C
        D
        E
        F
        G
        I
    end
```

### RÃ©sumÃ© des points importants

- **Cycle de vie structurÃ©** : Une requÃªte suit un chemin prÃ©cis (Request â†’ Kernel â†’ Routeur â†’ Middleware â†’ ContrÃ´leur â†’ ModÃ¨le â†’ Vue â†’ RÃ©ponse).
- **RÃ´le du routeur** : Le routeur dÃ©tecte la route correspondant Ã  la requÃªte et appelle le contrÃ´leur et la mÃ©thode associÃ©s.
- **Kernel** : Orchestre le chargement des configurations depuis le dossier config et initialise les modules.
- **ModularitÃ©** : Chaque composant (routeur, base de donnÃ©es, etc.) est indÃ©pendant, ce qui simplifie la gestion et amÃ©liore la maintenabilitÃ©.

## Contributing

Merci d'avoir envisagÃ© de contribuer Ã  Bow Framework ! Le guide de contribution se trouve dans la documentation.

- [Franck DAKIA](https://github.com/papac)
- [Merci aux collaborateurs](https://github.com/bowphp/app/graphs/contributors)

<SuggestionFeature />
