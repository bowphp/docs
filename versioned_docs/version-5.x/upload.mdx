---
id: http-upload
title: "üõ´ Envoi de fichier"
---

import SuggestionFeature from "@site/src/components/Partials/SuggestionFeature";

## Traiter les fichiers envoy√©s

:::info
Souvent les requ√™tes sont associ√©es √† des fichiers envoy√©s par l'utilisateur. Vous pouvez traiter ces fichiers avec [`Bow\Http\Request`](https://bowphp.com/api/master/Bow/Http/Request.html) via la m√©thode `file` et le helper du m√™me nom.
:::

Consid√©rons le formulaire suivant :

```html
<form action="/upload" method="post" enctype="multipart/form-data">
  <input type="file" name="photo" accept="image/png"><br/>
  <button type="submit">Uploader</button>
</form>
```

:::tip Question
Comment avoir acc√®s au fichier envoy√© ?
:::

Ici nous pouvons utiliser la m√©thode `file` qui retourne `null` ou une instance de [`Bow\Http\UploadFile`](https://bowphp.com/api/master/Bow/Http/UploadFile.html).

```php
use Bow\Http\Request;

$app->post('/upload', function(Request $request) {
  $file = $request->file('photo');
  // ou
  $file = file('photo');

  debug($file);
});
```

Le r√©sultat de `debug` :

```php
// Debug output
UploadFile {#92 ‚ñº
  -file: array:5 [‚ñº
    "name" => "23270116.png"
    "type" => "image/png"
    "tmp_name" => "/tmp/phpellwCx"
    "error" => 0
    "size" => 7388
  ]
}
```

## D√©terminer si un fichier existe

Vous pouvez d√©terminer si un fichier est pr√©sent sur la requ√™te en utilisant la m√©thode `hasFile` :

```php
if ($request->hasFile('photo')) {
  //
}
```

## Validation des t√©l√©chargements r√©ussis

Vous pouvez v√©rifier qu'il n'y a pas eu de probl√®mes lors du t√©l√©chargement avec la m√©thode `isUploaded`:

```php
$file = $request->file('photo');

if ($file->isUploaded()) {
  // Code ici
}
```

## Sauvegarder le fichier

Cela consiste juste √† d√©placer le fichier t√©l√©charg√© dans un autre dossier et ceci gr√¢ce √† la m√©thode `moveTo`.

```php
$file = $request->file('photo');

$file->moveTo("/path/to/your/store/directory", $filename = null);
```

Si `$filename` est `null`, sa valeur sera le nom du fichier hash√© avec la m√©thode [`getHashName`](https://bowphp.com/api/master/Bow/Http/UploadFile.html#method_getHashName).

:::tip Fichiers multiples
Souvent dans le cas o√π vous attendez des fichiers envoy√©s via un formulaire dont le champ est sous la forme `photo[]`, la m√©thode `file` retourne une [`Bow\Support\Collection`](https://bowphp.com/api/master/Bow/Support/Collection.html).
:::

```html
<form action="/upload" method="post" enctype="multipart/form-data">
  <label>Fichier 1: <input type="file" name="photo[]" accept="image/png"></label><br/>
  <label>Fichier 2: <input type="file" name="photo[]" accept="image/png"></label><br/>
  <button type="submit">Uploader</button>
</form>
```

Dans cet exemple, la m√©thode `file` retournera une [`Bow\Support\Collection`](https://bowphp.com/api/master/Bow/Support/Collection.html) qui contiendra pour chaque occurrence une instance de [`Bow\Http\UploadFile`](https://bowphp.com/api/master/Bow/Http/UploadFile.html).

```php
use Bow\Http\Request;
use Bow\Http\UploadFile;

$app->get('/upload', function (Request $request)
{
  $files = $request->file('photo');

  if (!$files->isEmpty()) {
    $files->each(function(UploadFile $file) {
      $file->moveTo("/path/to/your/store/directory");
    });
  }
});
```

<SuggestionFeature />
