---
id: http-session
title: "ðŸŽ¬ Session"
---

import SuggestionFeature from "@site/src/components/Partials/SuggestionFeature";

## Introduction

:::info
Les applications HTTP Ã©tant sans Ã©tat, les sessions offrent un moyen de stocker des informations sur l'utilisateur Ã  travers plusieurs requÃªtes.
:::

## Utilisation

### RÃ©cupÃ©ration des donnÃ©es

Il existe deux maniÃ¨res principales de travailler avec les donnÃ©es de `session` dans Bow : le helper global `session` et via une instance `Bow\Http\Request`.

PremiÃ¨rement, examinons l'accÃ¨s Ã  la session via une instance `Bow\Http\Request`, qui peut Ãªtre injectÃ©e sur une mÃ©thode de contrÃ´leur. N'oubliez pas que les dÃ©pendances des mÃ©thodes du contrÃ´leur sont automatiquement injectÃ©es via le conteneur Bow :

```php
namespace App\Controllers;

use App\Controllers\Controller;
use App\Models\User;
use Bow\Http\Request;

class UserController extends Controller
{
  /**
   * Afficher un utilisateur
   *
   * @param Request $request
   * @param int $id
   * @return Response
   */
  public function show(Request $request, $id)
  {
    $value = $request->session()->get('key');

    //
  }
}
```

Lorsque vous rÃ©cupÃ©rez un Ã©lÃ©ment de la session, vous pouvez Ã©galement transmettre une valeur par dÃ©faut comme deuxiÃ¨me argument de la mÃ©thode `get`. Cette valeur par dÃ©faut sera renvoyÃ©e si la clÃ© spÃ©cifiÃ©e n'existe pas dans la session. Si vous transmettez une `closure` en tant que valeur par dÃ©faut Ã  la mÃ©thode `get` et que la clÃ© demandÃ©e n'existe pas, la `closure` sera exÃ©cutÃ©e et son rÃ©sultat sera renvoyÃ©:

```php
$value = $request->session()->get('key', 'default');

$value = $request->session()->get('key', function () {
  return 'default';
});
```

### Le helper global de session

Vous pouvez Ã©galement utiliser la fonction PHP `session` globale pour rÃ©cupÃ©rer et stocker des donnÃ©es dans la session. Lorsque le helper `session` est appelÃ© avec un seul argument de chaÃ®ne, il renvoie la valeur de cette clÃ© de session. Lorsque le helper est appelÃ© avec un tableau de paires clÃ©/valeur, ces valeurs sont stockÃ©es dans la session :

```php
$app->get('home', function () {
  // RÃ©cupÃ©rer une donnÃ©e de la session
  $value = session('key');

  // SpÃ©cifier une valeur par dÃ©faut
  $value = session('key', 'default');

  // Stocker une donnÃ©e dans la session
  session(['key' => 'value']);
});
```

### RÃ©cupÃ©ration de toutes les donnÃ©es de session

Si vous souhaitez rÃ©cupÃ©rer toutes les donnÃ©es de la session, vous pouvez utiliser la mÃ©thode `all`:

```php
$data = $request->session()->all();
```

### DÃ©terminer si un Ã©lÃ©ment existe dans la session

Pour dÃ©terminer si un Ã©lÃ©ment est prÃ©sent dans la session, vous pouvez utiliser la mÃ©thode `has`. La mÃ©thode `has` renvoie `true` si l'Ã©lÃ©ment est prÃ©sent et n'est pas `null` :

```php
if ($request->session()->has('users')) {
  //
}
```

Pour dÃ©terminer si un Ã©lÃ©ment est prÃ©sent dans la session, mÃªme si sa valeur est `null`, vous pouvez utiliser la mÃ©thode `exists`. La mÃ©thode `exists` renvoie `true` si l'Ã©lÃ©ment est prÃ©sent:

```php
if ($request->session()->exists('users')) {
 //
}
```

### Stocker des donnÃ©es

Pour stocker des donnÃ©es dans la session, vous utiliserez gÃ©nÃ©ralement la mÃ©thode `put` ou le helper `session`.

```php
// Via une instance de requÃªte
$request->session()->set('key', 'value');

// Via le helper session...
session(['key' => 'value']);
```

## DonnÃ©es flash

:::tip Information
Parfois, vous souhaiterez peut-Ãªtre stocker des Ã©lÃ©ments dans la session uniquement pour la prochaine requÃªte. Les donnÃ©es flash sont principalement utiles pour les messages d'Ã©tat de courte durÃ©e.
:::

Vous pouvez le faire en utilisant la mÃ©thode `flash` ou le helper `flash`. Les donnÃ©es stockÃ©es dans la session Ã  l'aide de cette mÃ©thode ne seront disponibles que lors de la requÃªte HTTP suivante, puis seront supprimÃ©es.

```php
$request->session()->flash('status', 'Welcome !');
```

Si vous devez supprimer vos donnÃ©es flash, vous pouvez utiliser la mÃ©thode `clearFlash` :

```php
$request->session()->clearFlash();
```

## Suppression de donnÃ©es

La mÃ©thode `remove` supprimera une donnÃ©e de la session. Si vous souhaitez supprimer toutes les donnÃ©es de la session, vous pouvez utiliser la mÃ©thode `flush`. Si par contre vous souhaitez supprimer toutes les informations sauf les informations de flash, vous pouvez utiliser la mÃ©thode `clear` :

```php
// Supprimer une donnÃ©e de la session
$request->session()->remove('key');

// Supprimer toutes les informations sauf les informations de flash
$request->session()->clear();

// Supprimer toutes les donnÃ©es de la session
$request->session()->flush();
```

<SuggestionFeature />
