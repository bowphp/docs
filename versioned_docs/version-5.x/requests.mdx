---
id: http-request
title: "ðŸš€ Request"
---

import SuggestionFeature from "@site/src/components/Partials/SuggestionFeature";

- [Introduction](#introduction)
- [AccÃ©der Ã  la requÃªte](#accÃ©der-Ã -la-requÃªte)
- [RecupÃ©ration des donnÃ©es](#recupÃ©ration-des-donnÃ©es)
  - [Via des Closures de route](#via-des-closures-de-route)
  - [Via un controller](#via-un-controlleur)
- [Chemin de requÃªte et mÃ©thode](#chemin-de-requÃªte-et-mÃ©thode)
  - [RÃ©cupÃ©rer le chemin de requÃªte](#rÃ©cupÃ©rer-le-chemin-de-requÃªte)
  - [RÃ©cupÃ©rer la mÃ©thode de requÃªte](#rÃ©cupÃ©rer-la-mÃ©thode-de-requÃªte)
  - [VÃ©rifier si la requÃªte est en AJAX](#vÃ©rifier-si-la-requÃªte-est-en-ajax)
  - [RÃ©cupÃ©rer une entrÃ©e](#rÃ©cupÃ©rer-une-entrÃ©e)
  - [RecupÃ©ration d'une partie des donnÃ©es d'entrÃ©e](#recupÃ©ration-dune-partie-des-donnÃ©es-dentrÃ©e)
  - [DÃ©terminer si une valeur d'entrÃ©e est prÃ©sente](#dÃ©terminer-si-une-valeur-dentrÃ©e-est-prÃ©sente)
  - [DÃ©terminer l'adresse IP de client](#dÃ©terminer-ladresse-ip-de-client)
  - [DÃ©terminer le Port de client](#dÃ©terminer-le-port-de-client)
  - [DÃ©terminer le protocol de client](#dÃ©terminer-le-protocol-de-client)
  - [RÃ©cupÃ©rer les entÃªte-https](#rÃ©cupÃ©rer-les-entÃªte-https)
  - [RÃ©cupÃ©rer l'IP du serveur](#rÃ©cupÃ©rer-le-ip-du-server)
  - [RÃ©cupÃ©rer le domaine Origin](#rÃ©cupÃ©rer-le-domaine-origin)
  - [RÃ©cupÃ©rer le temps de la requÃªte](#rÃ©cupÃ©rer-le-temps-de-la-requÃªte)
  - [RÃ©cupÃ©rer une instance de la session](#rÃ©cupÃ©rer-une-instance-de-la-session)
  - [RÃ©cupÃ©rer l'authentification courante](#rÃ©cupÃ©rer-lauthentification-courante)

## Introduction

Une requÃªte HTTP est le message que l'utilisateur envoie Ã  l'application Bow via son navigateur ou d'autre outil tel que `curl`, `httpie` et autre.

Ce message est traitÃ© par Bow Ã  travers la classe [`Bow\Http\Request`](https://bowphp.com/api/master/Bow/Http/Request.html). Cette classe vous permet d'avoir les informations sur la requÃªte envoyÃ© par l'utilisateur comme son adresse ip, le type du message, les information d'un formulaire etc...

## AccÃ©der Ã  la requÃªte

Pour capturer un message ou requÃªte HTTP, vous pouvez premiÃ¨rement utiliser le helper `request()` qui vous donne une instance de [`Bow\Http\Request`](https://bowphp.com/api/master/Bow/Http/Request.html), deuxiÃ¨mement vous pouvez passer par l'injecteur de dÃ©pendance via une action de contrÃ´leur.

## RecupÃ©ration des donnÃ©es

En utilisant quelques mÃ©thodes simples, vous pouvez accÃ©der Ã  toutes les entrÃ©es utilisateur de votre application.

### Via des Closures de route

- Avec le helper `request`:

```php
$app->get('/', function () {
  $request = request();

  $name = $request->get('name');
  // code ici
});
```

- Par l'injection de dÃ©pendance

```php
use Bow\Http\Request;

$app->get('/', function (Request $request) {
  return $request->get('name');
});
```

```jsx title="/src/components/HelloCodeTitle.js"
function HelloCodeTitle(props) {
  return <h1>Hello, {props.name}</h1>;
}
```

### Via un controller

Si votre mÃ©thode de contrÃ´leur attend Ã©galement une entrÃ©e d'un paramÃ¨tre de route, vous devez rÃ©pertorier les paramÃ¨tres de votre route aprÃ¨s vos autres dÃ©pendances. Par exemple, si votre route est dÃ©fini comme suit:

```php
$app->get('/users/:id', 'UserController::show');
```

Vous pouvez toujours taper la requÃªte [Bow\Http\Request](https://bowphp.com/api/master/Bow/Http/Request.html) et accÃ©der Ã  l'id de votre paramÃ¨tre de route en dÃ©finissant votre mÃ©thode de contrÃ´leur comme suit:

```php
namespace App\Controllers;

use App\Controllers\Controller;
use App\Models\User;
use Bow\Http\Request;

class UserController extends Controller
{
  /**
   * Afficher le profil pour l'utilisateur donnÃ©
   *
   * @param Request $request
   * @return mixed
   */
  public function show(Request $request, $id)
  {
    $user = User::where('id', $id)->first();

    $user->name = $request->get('name');

    $user->save();

    return $this->render('user/profile', ['user' => $user]);
  }
}
```

## Chemin de requÃªte et mÃ©thode

### RÃ©cupÃ©rer le chemin de requÃªte

La mÃ©thode `path` renvoie les informations de chemin de la requÃªte. Ainsi, si la requÃªte entrante est ciblÃ©e sur `http://example.com/bar/zar`, la mÃ©thode path retournera `bar/zar`:

```php
$uri = $request->path();
```

La mÃ©thode `is` vous permet de vÃ©rifier que le chemin de requÃªte entrant correspond Ã  un modÃ¨le donnÃ©. Vous pouvez utiliser le caractÃ¨re `*` comme caractÃ¨re gÃ©nÃ©rique lorsque vous utilisez cette mÃ©thode:

```php
if ($request->is('users/*')) {
  //
}
```

### RÃ©cupÃ©rer la mÃ©thode de requÃªte

La mÃ©thode `method` retournera le verbe HTTP pour la requÃªte. Vous pouvez utiliser les mÃ©thodes `isPost`, `isGet`, `isPut`, `isDelete`, `isOptions`, `isPutch` pour vÃ©rifier que le verbe HTTP correspond Ã  une mÃ©thode HTTP de la requÃªte donnÃ©e:

```php
$method = $request->method();

if ($request->isPost()) {
  $filename = $request->file('filename');
  $filename->moveTo('/some/directory');
}
```

### VÃ©rifier si la requÃªte est en AJAX

Pour dÃ©terminer si une requÃªte a Ã©tÃ© envoyÃ© via AJAX, la mÃ©thode `isAjax` vous permet de vÃ©rifier Ã§a.

```php
if ($request->isAjax()) {
  //
}
```

### RÃ©cupÃ©rer une entrÃ©e

Souvent la requÃªte envoyÃ© par le client HTTP contient des donnÃ©es souvent demander pour actioner un mecanisme par exemple celui d'une inscription.

Bow Framework dans son dÃ©marrage optimise le donnÃ©e envoyÃ©s au serveur en remplaÃ§ant les valeur vide par `null` et supprimer les spaces blancs dans les valeurs de chaque champs avec la fonction php `trim`.

```php
$name = $request->get('name');

// RÃ©cupÃ©rer directement la valeur via le nom du champ
$name = $request->name;
```

> Vous pouvez aussi dÃ©fini une valeur par dÃ©faut Ã  `get`

```php
$name = $request->get('name', 'Papac');

$name = $request->get('name', function () {
  return User::first()->name;
});
```

Ceci permet justement de rÃ©cupÃ©rer le contenu du champ `name` d'un formulaire ou d'un url en fonction du type de requÃªte.

### RecupÃ©ration d'une partie des donnÃ©es d'entrÃ©e

Si vous devez extraire un sous-ensemble des donnÃ©es d'entrÃ©e, vous pouvez utiliser les mÃ©thodes `ignore` et `only`. Ces deux mÃ©thodes acceptent un seul tableau ou une liste d'arguments dynamique:

```php
$input = $request->only(['name', 'lastname']);

$input = $request->only('name', 'lastname');

$input = $request->ignore(['password']);

$input = $request->ignore('password');
```

### DÃ©terminer si une valeur d'entrÃ©e est prÃ©sente

Vous devez utiliser la mÃ©thode `has` pour dÃ©terminer si une valeur est prÃ©sente sur la requÃªte. La mÃ©thode `has` renvoie `true` si la valeur est prÃ©sente dans la requÃªte:

```php
if ($request->has('name')) {
  //
}
```

### DÃ©terminer l'adresse IP de client

Souvent vous allez vouloir l'adresse IP du client qui Ã  envoyer la requÃªte, la mÃ©thode `ip` permet comme son nom l'indique de rÃ©cupÃ©rer l'adresse ip de client:

```php
$ip = $request->ip();

if ($ip == 'xxx.xxx.xxx.xxx') {
  // code ici
}
```

### DÃ©terminer le Port de client

La mÃ©thode `port` permet comme son nom l'indique de rÃ©cupÃ©rer le port de client:

```php
$port = $request->port();

// Code ici
```

### DÃ©terminer le protocol de client

La mÃ©thode `protocol` permet comme son nom l'indique de rÃ©cupÃ©rer le protocol de client:

```php
$protocol = $request->protocol();

// Code ici
```

Il y a aussi la mÃ©thode `isProtocol` qui permet de faire de vÃ©rification sur le protocol:

```php
if ($request->isProtocol('http')) {
  //
}
```

Et `isSecure` vous permet de vÃ©rifier si la requÃªte est sÃ©curisÃ©.

```php
if ($request->isSecure()) {
  //
}
```

### RÃ©cupÃ©rer les entÃªte-https

Vous avez la possibilitÃ© de rÃ©cupÃ©rer les [entÃªte-https](https://developer.mozilla.org/fr/docs/Web/HTTP/Headers) du client avec la mÃ©thode `getHeader` et `hasHeader` pour vÃ©rifier l'existance d'une entÃªte-http.

```php
$header = $request->getHeader('content-type');

echo $header;
// text/html

if ($request->hasHeader('x-proxy-key')) {
  // code ici
}
```

### RÃ©cupÃ©rer le IP du server

Vous avez la possibilitÃ© de rÃ©cupÃ©rer l'adresse IP de serveur sur lequel votre application Bow est hÃ©bergÃ©.

```php
$hostname = $request->hostname();

echo $hostname;
// exemple.com
```

### RÃ©cupÃ©rer le domaine Origin

Le domaine dit `origin` est l'adresse rÃ©cupÃ©rer avec la mÃ©thode `hostname` ensuite associÃ© avec le protocol de la requÃªte.

```php
$hostname = $request->origin();

echo $hostname;
// https://exemple.com
```

### RÃ©cupÃ©rer le temps de la requÃªte

Il est souvent intÃ©ressÃ© de voir combien de temps Ã  faire une requÃªte. La mÃ©thode `time` nous permet de le faire et elle retourne un timestamp.

```php
$time = $request->time();

echo $time;
```

### RÃ©cupÃ©rer une instance de la session

Il est souvent intÃ©ressÃ© de manipuler la session directement. La mÃ©thode `session` nous permet de le faire et elle retourne l'instance de la session.

```php
$session = $request->session();

var_dump($session);
```

> Pour plus d'information sur la session, visitez cette page [HTTP Session](./session)

### RÃ©cupÃ©rer l'authentification courante

Vous pouvez aussi avoir l'authentification en cours si vous avez utilisÃ© le systÃ¨me d'authentification native de Bow Framework.

```php
$user = $request->user();

// DÃ©finir le guard
$user = $request->user('api');
```

<SuggestionFeature />
